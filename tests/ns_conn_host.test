#
# $Header$
#


package require tcltest 2.2
namespace import -force ::tcltest::*

eval ::tcltest::configure $argv


if {[ns_config test listenport]} {
    testConstraint serverListen true
}



set driverlocation http://[ns_config "ns/server/test/module/nssock" hostname]
set self ${driverlocation}:[ns_config "ns/server/test/module/nssock" port]



test ns_conn_location-1.1 {http 1.1 host} -constraints serverListen -setup {
    ns_register_proc GET /location {ns_return 200 text/plain [ns_conn location] ;#}
} -body {
    nstest_http -getbody 1 GET $self/location
} -cleanup {
    ns_unregister_proc GET /location
} -result [list 200 $self]



unset -nocomplain driverlocation self
cleanupTests
